# Development Guide: Expanding Your C++ Project Template

This guide explains how to add new libraries, files, and components to your C++ project template that uses Premake for build configuration.

## Table of Contents
- [Adding New Files to Existing Projects](#adding-new-files-to-existing-projects)
- [Creating Your Own Library](#creating-your-own-library)
- [Adding External Libraries](#adding-external-libraries)
- [Build System Management](#build-system-management)
- [Project Organization Best Practices](#project-organization-best-practices)
- [Common Patterns and Examples](#common-patterns-and-examples)

## Adding New Files to Existing Projects

### Adding Files to the Core Library

The Core library is designed to contain reusable code that can be shared across multiple applications.

**Location for new files:**
- **Headers**: `Core/Source/Core/YourHeader.h`
- **Implementation**: `Core/Source/Core/YourImplementation.cpp`

**Process:**
1. Create your `.h` and `.cpp` files in the `Core/Source/Core/` directory
2. No build configuration changes needed - Premake automatically includes all files matching `Source/**.h` and `Source/**.cpp`
3. Run your platform's setup script to regenerate build files
4. Build the project

**Example structure after adding files:**
```
Core/
├── Build-Core.lua
├── CMakeLists.txt
├── Makefile
└── Source/
    └── Core/
        ├── Core.h          (existing)
        ├── Core.cpp        (existing)
        ├── Math.h          (your new header)
        ├── Math.cpp        (your new implementation)
        ├── Logger.h        (another new header)
        └── Logger.cpp      (another new implementation)
```

### Adding Files to the App Project

The App project is your main executable that uses the Core library.

**Location for new files:**
- **Headers and Implementation**: `App/Source/YourFile.h` and `App/Source/YourFile.cpp`

**Process:**
1. Create your files in the `App/Source/` directory
2. No build configuration changes needed
3. You can include Core library headers using: `#include "Core/Core.h"`
4. Run setup script and build

## Creating Your Own Library

### Step 1: Directory Structure

Create a new library following the same pattern as Core:

```
YourLibrary/
├── Build-YourLibrary.lua    (Premake build script)
├── CMakeLists.txt          (CMake configuration for CLion)
├── Makefile               (Generated by Premake)
└── Source/
    └── YourLibrary/
        ├── YourLibrary.h
        └── YourLibrary.cpp
```

### Step 2: Create the Premake Build Script

Copy `Core/Build-Core.lua` to `YourLibrary/Build-YourLibrary.lua` and modify:

**Key changes to make:**
- Change `project "Core"` to `project "YourLibrary"`
- Update `targetdir` path if needed
- Adjust `includedirs` if you have special requirements
- Add any library-specific dependencies

### Step 3: Create CMake Configuration

Copy `Core/CMakeLists.txt` to `YourLibrary/CMakeLists.txt` and modify:

**Key changes:**
- Change project name references
- Update source file patterns if needed
- Add any specific compile definitions or flags

### Step 4: Update Main Build Files

**In `Build.lua` (root directory):**
1. Add your library to the appropriate group:
   ```lua
   group "Core"
       include "Core/Build-Core.lua"
       include "YourLibrary/Build-YourLibrary.lua"
   group ""
   ```

**In `CMakeLists.txt` (root directory):**
1. Add: `add_subdirectory(YourLibrary)`

### Step 5: Link Your Library to Other Projects

**To use your library in App, modify `App/Build-App.lua`:**
- Add to `includedirs`: `"../YourLibrary/Source"`
- Add to `links`: `"YourLibrary"`

**For CMake, update `App/CMakeLists.txt`:**
- Add to `target_link_libraries`: `YourLibrary`

### Step 6: Regenerate Build Files

Run your platform's setup script:
- macOS: `Scripts/Setup-macOS.sh`
- Windows: `Scripts/Setup-Windows.bat`
- Linux: `Scripts/Setup-Linux.sh`
- CLion: `Scripts/Setup-CLion.sh`

## Adding External Libraries

### Header-Only Libraries

**For libraries like GLM, Eigen, etc.:**

1. **Create vendor directory structure:**
   ```
   Vendor/
   ├── Binaries/          (existing)
   └── Include/
       ├── glm/           (example header-only library)
       ├── eigen/         (another example)
       └── your_library/
   ```

2. **Update your project's build script:**
   ```lua
   includedirs {
       "Source",
       "../Vendor/Include"  -- Add this line
   }
   ```

### Compiled Libraries

**For libraries that need to be linked:**

1. **Organize library files:**
   ```
   Vendor/
   ├── Libraries/
   │   ├── Debug/
   │   │   ├── libexample.a     (macOS/Linux)
   │   │   └── example.lib      (Windows)
   │   └── Release/
   │       ├── libexample.a
   │       └── example.lib
   └── Include/
       └── example/
           └── example.h
   ```

2. **Update build script with platform-specific linking:**
   ```lua
   includedirs {
       "Source",
       "../Vendor/Include"
   }
   
   filter "configurations:Debug"
       libdirs { "../Vendor/Libraries/Debug" }
   filter "configurations:Release"
       libdirs { "../Vendor/Libraries/Release" }
   filter {}
   
   filter "system:windows"
       links { "example" }
   filter "system:macosx or linux"
       links { "example" }
   filter {}
   ```

### Using Package Managers

**For vcpkg, Conan, or similar:**

1. **Install dependencies** using your package manager
2. **Update build scripts** to find packages
3. **Add appropriate** `find_package()` calls for CMake
4. **Configure include** and library paths in Premake

## Build System Management

### When to Regenerate Build Files

**Always run setup scripts after:**
- Adding new library projects
- Changing build configurations
- Adding external dependencies
- Modifying `.lua` build files
- Switching between architectures (ARM64/x64)

### Build Dependencies and Order

**Library dependency order matters:**
1. **Independent libraries** (no dependencies) build first
2. **Dependent libraries** build after their dependencies
3. **Executables** build last

**Example dependency chain:**
```
Math Library (independent)
    ↓
Graphics Library (depends on Math)
    ↓
App (depends on Core, Math, Graphics)
```

**Configure this in `Build.lua`:**
```lua
group "Foundation"
    include "Math/Build-Math.lua"
group "Graphics"  
    include "Graphics/Build-Graphics.lua"
group "Applications"
    include "App/Build-App.lua"
group ""
```

## Project Organization Best Practices

### Directory Naming Conventions

- **PascalCase** for project directories: `MyLibrary/`, `GraphicsEngine/`
- **lowercase** for build files: `build-mylibrary.lua`
- **Descriptive names** that indicate purpose

### Code Organization

**For libraries:**
```
YourLibrary/
└── Source/
    └── YourLibrary/
        ├── Public/          (public headers)
        │   ├── YourLibrary.h
        │   └── Utils.h
        ├── Private/         (private implementation)
        │   ├── Internal.h
        │   └── Internal.cpp
        ├── YourLibrary.cpp  (main implementation)
        └── Utils.cpp
```

**Include paths:**
- Public headers: `#include "YourLibrary/YourLibrary.h"`
- Private headers: `#include "YourLibrary/Private/Internal.h"`

### Namespace Organization

**Use consistent namespacing:**
```cpp
// In YourLibrary headers
namespace YourProject {
namespace YourLibrary {
    class YourClass {
        // implementation
    };
}
}

// Usage in App
using namespace YourProject::YourLibrary;
```

## Common Patterns and Examples

### Creating a Math Library

1. **Create directory:** `Math/`
2. **Structure:**
   ```
   Math/
   ├── Build-Math.lua
   ├── CMakeLists.txt
   └── Source/
       └── Math/
           ├── Vector3.h
           ├── Vector3.cpp
           ├── Matrix4.h
           └── Matrix4.cpp
   ```
3. **No external dependencies** needed
4. **Link to App** for usage

### Creating a Graphics Library

1. **Create directory:** `Graphics/`
2. **Add external dependencies:** OpenGL, GLFW, etc.
3. **Link Math library:** Add `"Math"` to links
4. **Platform-specific** configurations for graphics APIs

### Creating a Utility Library

1. **Create directory:** `Utils/`
2. **Add common utilities:** file I/O, string helpers, etc.
3. **Header-only option:** Just headers in `Source/Utils/`
4. **Widely linkable:** Most projects can depend on this

### Multi-Platform Considerations

**Handle platform differences in build scripts:**
```lua
filter "system:windows"
    defines { "PLATFORM_WINDOWS" }
    links { "opengl32", "user32", "gdi32" }

filter "system:macosx"
    defines { "PLATFORM_MACOS" }
    links { "OpenGL.framework", "Cocoa.framework" }

filter "system:linux"
    defines { "PLATFORM_LINUX" }
    links { "GL", "X11", "pthread" }

filter {}
```

## Troubleshooting

### Common Issues

**Build errors after adding new library:**
- Check dependency order in `Build.lua`
- Verify include paths are correct
- Ensure all required libraries are linked

**CMake configuration issues:**
- Run `Scripts/Setup-CLion.sh` to regenerate
- Check `CMakeLists.txt` syntax
- Verify `add_subdirectory()` calls are present

**Missing symbols at link time:**
- Check library is actually being built
- Verify library is in the `links` section
- Ensure proper architecture matching (ARM64 vs x64)

### Getting Help

**Debug build issues:**
1. **Check generated Makefiles** in project directories
2. **Look at compile commands** for missing includes
3. **Verify library output** in `Binaries/` directory
4. **Test with minimal example** first

This template is designed to be flexible and extensible. Start small with simple additions and gradually build up to more complex multi-library projects as you become comfortable with the build system.
